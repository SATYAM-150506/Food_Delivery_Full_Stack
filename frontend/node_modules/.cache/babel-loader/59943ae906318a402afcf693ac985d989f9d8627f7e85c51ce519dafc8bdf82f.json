{"ast":null,"code":"import React,{useState,useContext}from'react';import{useNavigate,Link,useLocation}from'react-router-dom';import{AuthContext}from'../../Context/AuthContext';import Loader from'../../components/Loader';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{var _location$state,_location$state$from;const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[error,setError]=useState('');const[success,setSuccess]=useState('');const[loading,setLoading]=useState(false);const navigate=useNavigate();const location=useLocation();const{login}=useContext(AuthContext);// Get redirect path from location state, query params, or localStorage\nconst urlParams=new URLSearchParams(location.search);const queryRedirect=urlParams.get('redirect');const storedRedirect=localStorage.getItem('redirectAfterLogin');// Build redirect path - prioritize explicit redirects, default to home\nconst redirectPath=((_location$state=location.state)===null||_location$state===void 0?void 0:(_location$state$from=_location$state.from)===null||_location$state$from===void 0?void 0:_location$state$from.pathname)||(queryRedirect?\"/\".concat(queryRedirect):'')||storedRedirect||'/';const handleSubmit=async e=>{e.preventDefault();setLoading(true);setError('');setSuccess('');try{await login({email,password});setSuccess('Login successful! Redirecting...');// Clear the stored redirect\nlocalStorage.removeItem('redirectAfterLogin');setTimeout(()=>{navigate(redirectPath,{replace:true});},1000);}catch(err){var _err$response,_err$response$data;console.error('Login error:',err);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||'Login failed. Please check your credentials.');setTimeout(()=>setError(''),4000);}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen bg-gradient-to-br from-yellow-100 via-red-100 to-pink-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 p-4\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"bg-white dark:bg-gray-800 p-8 md:p-10 rounded-3xl shadow-2xl dark:shadow-gray-900/50 w-full max-w-md relative overflow-hidden animate-fadeIn\",\"aria-label\":\"Login form\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold mb-6 text-gray-800 dark:text-white text-center\",children:\"Login\"}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-4\",children:/*#__PURE__*/_jsx(Loader,{})}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 mb-4 text-center animate-pulse font-medium\",children:error}),success&&/*#__PURE__*/_jsx(\"p\",{className:\"text-green-500 mb-4 text-center animate-fadeIn font-medium\",children:success}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative mb-6\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",placeholder:\" \",className:\"peer w-full border-b-2 border-gray-300 dark:border-gray-600 focus:border-yellow-500 dark:focus:border-yellow-400 outline-none py-2 placeholder-transparent transition-colors bg-transparent dark:text-white\",value:email,onChange:e=>setEmail(e.target.value),required:true,\"aria-label\":\"Email\",autoComplete:\"email\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",className:\"absolute left-0 -top-3.5 text-gray-500 dark:text-gray-400 text-sm transition-all peer-placeholder-shown:top-2 peer-placeholder-shown:text-gray-400 dark:peer-placeholder-shown:text-gray-500 peer-placeholder-shown:text-base peer-focus:-top-3.5 peer-focus:text-gray-500 dark:peer-focus:text-gray-300 peer-focus:text-sm\",children:\"Email\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative mb-6\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",placeholder:\" \",className:\"peer w-full border-b-2 border-gray-300 dark:border-gray-600 focus:border-yellow-500 dark:focus:border-yellow-400 outline-none py-2 placeholder-transparent transition-colors bg-transparent dark:text-white\",value:password,onChange:e=>setPassword(e.target.value),required:true,\"aria-label\":\"Password\",autoComplete:\"current-password\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:\"absolute left-0 -top-3.5 text-gray-500 dark:text-gray-400 text-sm transition-all peer-placeholder-shown:top-2 peer-placeholder-shown:text-gray-400 dark:peer-placeholder-shown:text-gray-500 peer-placeholder-shown:text-base peer-focus:-top-3.5 peer-focus:text-gray-500 dark:peer-focus:text-gray-300 peer-focus:text-sm\",children:\"Password\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full py-3 bg-gradient-to-r from-yellow-400 via-red-400 to-pink-500 dark:from-yellow-500 dark:via-red-500 dark:to-pink-600 text-white font-semibold rounded-xl shadow-lg hover:scale-105 transform transition-all duration-300 disabled:opacity-60\",disabled:loading,children:loading?'Logging In...':'Login'}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-4 text-sm text-gray-500 dark:text-gray-400 text-center\",children:[\"Don't have an account?\",' ',/*#__PURE__*/_jsx(Link,{to:\"/signup\",className:\"text-yellow-500 dark:text-yellow-400 font-medium hover:underline\",children:\"Sign Up\"})]})]})});};export default Login;","map":{"version":3,"names":["React","useState","useContext","useNavigate","Link","useLocation","AuthContext","Loader","jsx","_jsx","jsxs","_jsxs","Login","_location$state","_location$state$from","email","setEmail","password","setPassword","error","setError","success","setSuccess","loading","setLoading","navigate","location","login","urlParams","URLSearchParams","search","queryRedirect","get","storedRedirect","localStorage","getItem","redirectPath","state","from","pathname","concat","handleSubmit","e","preventDefault","removeItem","setTimeout","replace","err","_err$response","_err$response$data","console","response","data","className","children","onSubmit","type","id","placeholder","value","onChange","target","required","autoComplete","htmlFor","disabled","to"],"sources":["D:/food_delievery2/frontend/src/assets/pages/Auth/Login.jsx"],"sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport { useNavigate, Link, useLocation } from 'react-router-dom';\r\nimport { AuthContext } from '../../Context/AuthContext';\r\nimport Loader from '../../components/Loader';\r\n\r\nconst Login = () => {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { login } = useContext(AuthContext);\r\n\r\n  // Get redirect path from location state, query params, or localStorage\r\n  const urlParams = new URLSearchParams(location.search);\r\n  const queryRedirect = urlParams.get('redirect');\r\n  const storedRedirect = localStorage.getItem('redirectAfterLogin');\r\n  \r\n  // Build redirect path - prioritize explicit redirects, default to home\r\n  const redirectPath = location.state?.from?.pathname || \r\n                       (queryRedirect ? `/${queryRedirect}` : '') || \r\n                       storedRedirect || \r\n                       '/';\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError('');\r\n    setSuccess('');\r\n    \r\n    try {\r\n      await login({ email, password });\r\n      setSuccess('Login successful! Redirecting...');\r\n      \r\n      // Clear the stored redirect\r\n      localStorage.removeItem('redirectAfterLogin');\r\n      \r\n      setTimeout(() => {\r\n        navigate(redirectPath, { replace: true });\r\n      }, 1000);\r\n    } catch (err) {\r\n      console.error('Login error:', err);\r\n      setError(err.response?.data?.error || 'Login failed. Please check your credentials.');\r\n      setTimeout(() => setError(''), 4000);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-yellow-100 via-red-100 to-pink-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 p-4\">\r\n      <form\r\n        onSubmit={handleSubmit}\r\n        className=\"bg-white dark:bg-gray-800 p-8 md:p-10 rounded-3xl shadow-2xl dark:shadow-gray-900/50 w-full max-w-md relative overflow-hidden animate-fadeIn\"\r\n        aria-label=\"Login form\"\r\n      >\r\n        <h2 className=\"text-3xl font-extrabold mb-6 text-gray-800 dark:text-white text-center\">\r\n          Login\r\n        </h2>\r\n\r\n        {loading && (\r\n          <div className=\"flex justify-center mb-4\">\r\n            <Loader />\r\n          </div>\r\n        )}\r\n        {error && (\r\n          <p className=\"text-red-500 mb-4 text-center animate-pulse font-medium\">\r\n            {error}\r\n          </p>\r\n        )}\r\n        {success && (\r\n          <p className=\"text-green-500 mb-4 text-center animate-fadeIn font-medium\">\r\n            {success}\r\n          </p>\r\n        )}\r\n\r\n        {/* Email Input */}\r\n        <div className=\"relative mb-6\">\r\n          <input\r\n            type=\"email\"\r\n            id=\"email\"\r\n            placeholder=\" \"\r\n            className=\"peer w-full border-b-2 border-gray-300 dark:border-gray-600 focus:border-yellow-500 dark:focus:border-yellow-400 outline-none py-2 placeholder-transparent transition-colors bg-transparent dark:text-white\"\r\n            value={email}\r\n            onChange={e => setEmail(e.target.value)}\r\n            required\r\n            aria-label=\"Email\"\r\n            autoComplete=\"email\"\r\n          />\r\n          <label\r\n            htmlFor=\"email\"\r\n            className=\"absolute left-0 -top-3.5 text-gray-500 dark:text-gray-400 text-sm transition-all peer-placeholder-shown:top-2 peer-placeholder-shown:text-gray-400 dark:peer-placeholder-shown:text-gray-500 peer-placeholder-shown:text-base peer-focus:-top-3.5 peer-focus:text-gray-500 dark:peer-focus:text-gray-300 peer-focus:text-sm\"\r\n          >\r\n            Email\r\n          </label>\r\n        </div>\r\n\r\n        {/* Password Input */}\r\n        <div className=\"relative mb-6\">\r\n          <input\r\n            type=\"password\"\r\n            id=\"password\"\r\n            placeholder=\" \"\r\n            className=\"peer w-full border-b-2 border-gray-300 dark:border-gray-600 focus:border-yellow-500 dark:focus:border-yellow-400 outline-none py-2 placeholder-transparent transition-colors bg-transparent dark:text-white\"\r\n            value={password}\r\n            onChange={e => setPassword(e.target.value)}\r\n            required\r\n            aria-label=\"Password\"\r\n            autoComplete=\"current-password\"\r\n          />\r\n          <label\r\n            htmlFor=\"password\"\r\n            className=\"absolute left-0 -top-3.5 text-gray-500 dark:text-gray-400 text-sm transition-all peer-placeholder-shown:top-2 peer-placeholder-shown:text-gray-400 dark:peer-placeholder-shown:text-gray-500 peer-placeholder-shown:text-base peer-focus:-top-3.5 peer-focus:text-gray-500 dark:peer-focus:text-gray-300 peer-focus:text-sm\"\r\n          >\r\n            Password\r\n          </label>\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          className=\"w-full py-3 bg-gradient-to-r from-yellow-400 via-red-400 to-pink-500 dark:from-yellow-500 dark:via-red-500 dark:to-pink-600 text-white font-semibold rounded-xl shadow-lg hover:scale-105 transform transition-all duration-300 disabled:opacity-60\"\r\n          disabled={loading}\r\n        >\r\n          {loading ? 'Logging In...' : 'Login'}\r\n        </button>\r\n\r\n        <p className=\"mt-4 text-sm text-gray-500 dark:text-gray-400 text-center\">\r\n          Don't have an account?{' '}\r\n          <Link to=\"/signup\" className=\"text-yellow-500 dark:text-yellow-400 font-medium hover:underline\">\r\n            Sign Up\r\n          </Link>\r\n        </p>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _objectSpread from\"D:/food_delievery2/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import axios from'axios';const API_BASE_URL=process.env.REACT_APP_API_URL||'http://localhost:5000';// Create axios instance for payments with proper auth configuration\nconst paymentAPI=axios.create({baseURL:API_BASE_URL,withCredentials:true,headers:{'Content-Type':'application/json'}});// Add token to requests automatically\npaymentAPI.interceptors.request.use(config=>{const token=localStorage.getItem('token');if(token){config.headers.Authorization=\"Bearer \".concat(token);}return config;},error=>{return Promise.reject(error);});// Response interceptor to handle auth errors\npaymentAPI.interceptors.response.use(response=>response,error=>{var _error$response;if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){localStorage.removeItem('token');}return Promise.reject(error);});const API='/api/payment';const paymentService={// Create Razorpay order\ncreatePaymentOrder:async data=>{const res=await paymentAPI.post(\"\".concat(API,\"/create-order\"),data);return res.data;},// Process payment (create order)\nprocessPayment:async data=>{const res=await paymentAPI.post(\"\".concat(API,\"/pay\"),data);return res.data;},// Verify payment after successful transaction\nverifyPayment:async data=>{const res=await paymentAPI.post(\"\".concat(API,\"/verify\"),data);return res.data;},// Handle payment failure\npaymentFailed:async data=>{const res=await paymentAPI.post(\"\".concat(API,\"/failed\"),data);return res.data;},// Initialize Razorpay payment\ninitiateRazorpayPayment:options=>{return new Promise((resolve,reject)=>{const rzp=new window.Razorpay(_objectSpread(_objectSpread({},options),{},{handler:function(response){resolve(response);},modal:{ondismiss:function(){reject(new Error('Payment cancelled by user'));}}}));rzp.open();});}};export default paymentService;","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","paymentAPI","create","baseURL","withCredentials","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","concat","error","Promise","reject","response","_error$response","status","removeItem","API","paymentService","createPaymentOrder","data","res","post","processPayment","verifyPayment","paymentFailed","initiateRazorpayPayment","options","resolve","rzp","window","Razorpay","_objectSpread","handler","modal","ondismiss","Error","open"],"sources":["D:/food_delievery2/frontend/src/assets/services/paymentService.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000';\r\n\r\n// Create axios instance for payments with proper auth configuration\r\nconst paymentAPI = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  withCredentials: true,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  }\r\n});\r\n\r\n// Add token to requests automatically\r\npaymentAPI.interceptors.request.use((config) => {\r\n  const token = localStorage.getItem('token');\r\n  if (token) {\r\n    config.headers.Authorization = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n}, (error) => {\r\n  return Promise.reject(error);\r\n});\r\n\r\n// Response interceptor to handle auth errors\r\npaymentAPI.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    if (error.response?.status === 401) {\r\n      localStorage.removeItem('token');\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nconst API = '/api/payment';\r\n\r\nconst paymentService = {\r\n  // Create Razorpay order\r\n  createPaymentOrder: async (data) => {\r\n    const res = await paymentAPI.post(`${API}/create-order`, data);\r\n    return res.data;\r\n  },\r\n\r\n  // Process payment (create order)\r\n  processPayment: async (data) => {\r\n    const res = await paymentAPI.post(`${API}/pay`, data);\r\n    return res.data;\r\n  },\r\n\r\n  // Verify payment after successful transaction\r\n  verifyPayment: async (data) => {\r\n    const res = await paymentAPI.post(`${API}/verify`, data);\r\n    return res.data;\r\n  },\r\n\r\n  // Handle payment failure\r\n  paymentFailed: async (data) => {\r\n    const res = await paymentAPI.post(`${API}/failed`, data);\r\n    return res.data;\r\n  },\r\n\r\n  // Initialize Razorpay payment\r\n  initiateRazorpayPayment: (options) => {\r\n    return new Promise((resolve, reject) => {\r\n      const rzp = new window.Razorpay({\r\n        ...options,\r\n        handler: function (response) {\r\n          resolve(response);\r\n        },\r\n        modal: {\r\n          ondismiss: function () {\r\n            reject(new Error('Payment cancelled by user'));\r\n          }\r\n        }\r\n      });\r\n      rzp.open();\r\n    });\r\n  }\r\n};\r\n\r\nexport default paymentService;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
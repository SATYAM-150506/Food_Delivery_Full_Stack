{"ast":null,"code":"var _jsxFileName = \"D:\\\\food_delievery2\\\\frontend\\\\src\\\\assets\\\\Context\\\\CartContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport { AuthContext } from './AuthContext';\nimport cartService from '../services/cartService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const CartContext = /*#__PURE__*/createContext();\nexport const CartProvider = ({\n  children\n}) => {\n  _s();\n  const [cart, setCart] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const {\n    user\n  } = useContext(AuthContext);\n  useEffect(() => {\n    fetchCart();\n  }, [user]);\n  const fetchCart = async () => {\n    setLoading(true);\n    try {\n      if (user) {\n        // For authenticated users, fetch from backend\n        const cartData = await cartService.getCart();\n        setCart(cartData || []);\n      } else {\n        // For guests, load from localStorage\n        const localCart = JSON.parse(localStorage.getItem('guestCart') || '[]');\n        setCart(localCart);\n      }\n    } catch (error) {\n      console.error('Failed to fetch cart:', error);\n      // Fallback to localStorage if backend fails\n      const localCart = JSON.parse(localStorage.getItem('guestCart') || '[]');\n      setCart(localCart);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const saveToLocalStorage = cartData => {\n    localStorage.setItem('guestCart', JSON.stringify(cartData));\n  };\n  const addToCart = async (product, quantity = 1) => {\n    try {\n      if (user) {\n        // For authenticated users, use backend\n        const updatedCart = await cartService.addToCart(product._id, quantity);\n        setCart(updatedCart);\n      } else {\n        // For guests, use localStorage\n        const currentCart = [...cart];\n        const existingItemIndex = currentCart.findIndex(item => item._id === product._id);\n        if (existingItemIndex > -1) {\n          currentCart[existingItemIndex].quantity += quantity;\n        } else {\n          currentCart.push({\n            ...product,\n            quantity\n          });\n        }\n        setCart(currentCart);\n        saveToLocalStorage(currentCart);\n      }\n    } catch (error) {\n      console.error('Failed to add to cart:', error);\n      // Fallback to localStorage even for authenticated users if backend fails\n      const currentCart = [...cart];\n      const existingItemIndex = currentCart.findIndex(item => item._id === product._id);\n      if (existingItemIndex > -1) {\n        currentCart[existingItemIndex].quantity += quantity;\n      } else {\n        currentCart.push({\n          ...product,\n          quantity\n        });\n      }\n      setCart(currentCart);\n      saveToLocalStorage(currentCart);\n    }\n  };\n  const updateQuantity = async (productId, quantity) => {\n    try {\n      if (user) {\n        // For authenticated users, use backend\n        const updatedCart = await cartService.updateCartItem(productId, quantity);\n        setCart(updatedCart);\n      } else {\n        // For guests, use localStorage\n        const currentCart = cart.map(item => item._id === productId ? {\n          ...item,\n          quantity\n        } : item).filter(item => item.quantity > 0);\n        setCart(currentCart);\n        saveToLocalStorage(currentCart);\n      }\n    } catch (error) {\n      console.error('Failed to update quantity:', error);\n      // Fallback to localStorage\n      const currentCart = cart.map(item => item._id === productId ? {\n        ...item,\n        quantity\n      } : item).filter(item => item.quantity > 0);\n      setCart(currentCart);\n      saveToLocalStorage(currentCart);\n    }\n  };\n  const removeFromCart = async productId => {\n    try {\n      if (user) {\n        // For authenticated users, use backend\n        const updatedCart = await cartService.removeFromCart(productId);\n        setCart(updatedCart);\n      } else {\n        // For guests, use localStorage\n        const currentCart = cart.filter(item => item._id !== productId);\n        setCart(currentCart);\n        saveToLocalStorage(currentCart);\n      }\n    } catch (error) {\n      console.error('Failed to remove from cart:', error);\n      // Fallback to localStorage\n      const currentCart = cart.filter(item => item._id !== productId);\n      setCart(currentCart);\n      saveToLocalStorage(currentCart);\n    }\n  };\n  const clearCart = async () => {\n    try {\n      if (user) {\n        await cartService.clearCart();\n      }\n      setCart([]);\n      localStorage.removeItem('guestCart');\n    } catch (error) {\n      console.error('Failed to clear cart:', error);\n      setCart([]);\n      localStorage.removeItem('guestCart');\n    }\n  };\n  const getCartTotal = () => {\n    return cart.reduce((total, item) => total + item.price * item.quantity, 0);\n  };\n  const getCartItemsCount = () => {\n    return cart.reduce((total, item) => total + item.quantity, 0);\n  };\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: {\n      cart,\n      cartItems: cart,\n      // For backward compatibility\n      loading,\n      addToCart,\n      updateQuantity,\n      removeFromCart,\n      clearCart,\n      fetchCart,\n      getCartTotal,\n      getCartItemsCount\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 150,\n    columnNumber: 5\n  }, this);\n};\n_s(CartProvider, \"43xiNHxQU82ixDRBFmw6ha92RO0=\");\n_c = CartProvider;\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","AuthContext","cartService","jsxDEV","_jsxDEV","CartContext","CartProvider","children","_s","cart","setCart","loading","setLoading","user","fetchCart","cartData","getCart","localCart","JSON","parse","localStorage","getItem","error","console","saveToLocalStorage","setItem","stringify","addToCart","product","quantity","updatedCart","_id","currentCart","existingItemIndex","findIndex","item","push","updateQuantity","productId","updateCartItem","map","filter","removeFromCart","clearCart","removeItem","getCartTotal","reduce","total","price","getCartItemsCount","Provider","value","cartItems","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/food_delievery2/frontend/src/assets/Context/CartContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\r\nimport { AuthContext } from './AuthContext';\r\nimport cartService from '../services/cartService';\r\n\r\nexport const CartContext = createContext();\r\n\r\nexport const CartProvider = ({ children }) => {\r\n  const [cart, setCart] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const { user } = useContext(AuthContext);\r\n\r\n  useEffect(() => {\r\n    fetchCart();\r\n  }, [user]);\r\n\r\n  const fetchCart = async () => {\r\n    setLoading(true);\r\n    try {\r\n      if (user) {\r\n        // For authenticated users, fetch from backend\r\n        const cartData = await cartService.getCart();\r\n        setCart(cartData || []);\r\n      } else {\r\n        // For guests, load from localStorage\r\n        const localCart = JSON.parse(localStorage.getItem('guestCart') || '[]');\r\n        setCart(localCart);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch cart:', error);\r\n      // Fallback to localStorage if backend fails\r\n      const localCart = JSON.parse(localStorage.getItem('guestCart') || '[]');\r\n      setCart(localCart);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const saveToLocalStorage = (cartData) => {\r\n    localStorage.setItem('guestCart', JSON.stringify(cartData));\r\n  };\r\n\r\n  const addToCart = async (product, quantity = 1) => {\r\n    try {\r\n      if (user) {\r\n        // For authenticated users, use backend\r\n        const updatedCart = await cartService.addToCart(product._id, quantity);\r\n        setCart(updatedCart);\r\n      } else {\r\n        // For guests, use localStorage\r\n        const currentCart = [...cart];\r\n        const existingItemIndex = currentCart.findIndex(item => item._id === product._id);\r\n        \r\n        if (existingItemIndex > -1) {\r\n          currentCart[existingItemIndex].quantity += quantity;\r\n        } else {\r\n          currentCart.push({ ...product, quantity });\r\n        }\r\n        \r\n        setCart(currentCart);\r\n        saveToLocalStorage(currentCart);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to add to cart:', error);\r\n      // Fallback to localStorage even for authenticated users if backend fails\r\n      const currentCart = [...cart];\r\n      const existingItemIndex = currentCart.findIndex(item => item._id === product._id);\r\n      \r\n      if (existingItemIndex > -1) {\r\n        currentCart[existingItemIndex].quantity += quantity;\r\n      } else {\r\n        currentCart.push({ ...product, quantity });\r\n      }\r\n      \r\n      setCart(currentCart);\r\n      saveToLocalStorage(currentCart);\r\n    }\r\n  };\r\n\r\n  const updateQuantity = async (productId, quantity) => {\r\n    try {\r\n      if (user) {\r\n        // For authenticated users, use backend\r\n        const updatedCart = await cartService.updateCartItem(productId, quantity);\r\n        setCart(updatedCart);\r\n      } else {\r\n        // For guests, use localStorage\r\n        const currentCart = cart.map(item =>\r\n          item._id === productId ? { ...item, quantity } : item\r\n        ).filter(item => item.quantity > 0);\r\n        \r\n        setCart(currentCart);\r\n        saveToLocalStorage(currentCart);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to update quantity:', error);\r\n      // Fallback to localStorage\r\n      const currentCart = cart.map(item =>\r\n        item._id === productId ? { ...item, quantity } : item\r\n      ).filter(item => item.quantity > 0);\r\n      \r\n      setCart(currentCart);\r\n      saveToLocalStorage(currentCart);\r\n    }\r\n  };\r\n\r\n  const removeFromCart = async (productId) => {\r\n    try {\r\n      if (user) {\r\n        // For authenticated users, use backend\r\n        const updatedCart = await cartService.removeFromCart(productId);\r\n        setCart(updatedCart);\r\n      } else {\r\n        // For guests, use localStorage\r\n        const currentCart = cart.filter(item => item._id !== productId);\r\n        setCart(currentCart);\r\n        saveToLocalStorage(currentCart);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to remove from cart:', error);\r\n      // Fallback to localStorage\r\n      const currentCart = cart.filter(item => item._id !== productId);\r\n      setCart(currentCart);\r\n      saveToLocalStorage(currentCart);\r\n    }\r\n  };\r\n\r\n  const clearCart = async () => {\r\n    try {\r\n      if (user) {\r\n        await cartService.clearCart();\r\n      }\r\n      setCart([]);\r\n      localStorage.removeItem('guestCart');\r\n    } catch (error) {\r\n      console.error('Failed to clear cart:', error);\r\n      setCart([]);\r\n      localStorage.removeItem('guestCart');\r\n    }\r\n  };\r\n\r\n  const getCartTotal = () => {\r\n    return cart.reduce((total, item) => total + (item.price * item.quantity), 0);\r\n  };\r\n\r\n  const getCartItemsCount = () => {\r\n    return cart.reduce((total, item) => total + item.quantity, 0);\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider value={{\r\n      cart,\r\n      cartItems: cart, // For backward compatibility\r\n      loading,\r\n      addToCart,\r\n      updateQuantity,\r\n      removeFromCart,\r\n      clearCart,\r\n      fetchCart,\r\n      getCartTotal,\r\n      getCartItemsCount\r\n    }}>\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}